# 动态模块加载

1. 空间不是很够，，不打算装虚拟机。需要别的解决方案。
   1. 使用ubuntu-base系统+chroot指令得到一个sandbox
   2. sandbox中没有dev sys run proc 等运行时重要资源
   3. 自行将自己的ubuntu系统下的dev 等挂载到 要chroot的/路径下

2. V2.4失败，原因可能如下
   1. 内核版本冲突
   2. gcc版本冲突

3. v2.6直接编译失败
   1. linux/init.h库需要到指定路径下的编译器编译

4. sudo insmod modify_syscall.ko 失败
   1. 高版本内核的syscall table是只读的
   2. 使用内核版本比较低的ubuntu虚拟机
   3. virtualbox+ubuntu10.04

5. 依旧被杀
   1. 加入解除系统调用表的写保护
   2. dmesg 可以看到输出了

6. 尝试使用调用计算加减得到错误答案-1
   1. 将函数返回值改为固定数字，依然得到-1,说明可能对表的修改失败了，或者指向了错误的位置
   2. 真的没辙了，google前一整页都试过了，没用。

# 字符设备驱动
1. ch_device.c 不能引入stdio.h等标准c库
   1. 因为使用的是专用的内核编译器
   2. 只能将信号量放在测试端来实现

2. 判断当前在线测试端个数
   1. 启动时更新，如果是第一个测试端则注册信号量
   2. 结束时更新，如果是最后一个测试端则注销信号量
   3. 统一通过userReception注册，以及注销

3. 信号量控制
   1. semctl
   2. semget
   3. semop

4. 如何判别当前剩余测试端
   1. 手动启动首个测试端并手动让其最后注销（不够智能）
   2. 模仿hard link文件系统设计，只有当所有测试端都被注销时，信号量才被注销

5. 模拟广播式信道接受原理
   1. 发送方需要进行冲突检测、冲突避免
   2. 接收方接受并判断接受信息是否为最新，并不做互斥判断